"use strict";angular.module("chequesApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ui.utils.masks"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).otherwise({redirectTo:"/"})}]),angular.module("chequesApp").controller("MainCtrl",["$scope",function(a){a.init=function(){a.cheques=[142.75300732942,1992.2281988627,762.59871167717,2672.7218359815,593.75581408094,2016.807615695,1830.2684736346,928.29185208692,1562.3968399653,1778.9732755995,77.315295826325,511.72777379943,1391.2501540926,2153.8754689758,2646.5870890052,1866.98667175,95.096584733155,2962.5126132334,1852.2217330766,2001.5792618047],a.model={cheque:null},a.clearResults()},a.removeAllCheques=function(){window.confirm("Apagar todos os cheques digitados. Deseja continuar?")&&(a.clearResults(),a.cheques=[])},a.clearResults=function(){a.troco=0,a.melhorCombinacaoComTroco=[],a.menorDiferenca=0,a.diferencaMaiorCombinacao=0,a.maiorCombinacaoComDiferenca=[],a.menorCombinacaoComDiferenca=[],a.melhorCombinacaoComDiferenca=[]},a.addCheque=function(){a.cheques.push(Number(a.model.cheque)),a.model.cheque=null,$("#novo-cheque").focus()},a.removeCheque=function(b){a.cheques=_.without(a.cheques,a.cheques[b])},a.execute=function(){a.clearResults();var b=a.valor,c=0,d=0,e=a.cheques.length,f=_.sortBy(a.cheques),g=[],h=0,i=_.sum(f)-b,j=0,k=null,l=null,m=_.times(e,_.constant(0)),n=[];for(c=0;e>c;c++)for(g.push([]),d=0;e>d;d++)f[(c+d)%e]>0&&(g[c][d]=f[(c+d)%e],j=_.sum(g[c]),b>=j&&j>h&&(h=j,k=[].concat(g[c]),g[c].length<m.length&&(m=[].concat(g[c])),g[c].length>n.length&&(n=[].concat(g[c]))),j>b&&j-b>0&&i>j-b&&b>j-b&&(i=j-b,l=[].concat(g[c])));a.melhorCombinacaoComTroco=l,a.troco=i,a.melhorCombinacaoComDiferenca=k,a.menorDiferenca=b-h,a.maiorCombinacaoComDiferenca=n,a.diferencaMaiorCombinacao=b-_.sum(n),a.menorCombinacaoComDiferenca=m,a.diferencaMenorCombinacao=b-_.sum(m)},a.init(),a.$watch("cheques",function(b,c){b&&a.clearResults()},!0)}]),angular.module("chequesApp").run(["$templateCache",function(a){a.put("views/main.html",'<div class="container"> <div class="col-xs-12 col-md-4"> <ul class="list-group"> <li class="list-group-item"> <h4> Lista de cheques <button title="remover todos os cheques" ng-click="removeAllCheques()" class="btn btn-warning btn-xs pull-right"> <span class="fa fa-ban"></span> </button> </h4> </li> <li class="list-group-item"> <div class="form-group" style="margin-bottom: 0"> <div class="input-group"> <input type="text" id="novo-cheque" ui-number-mask ui-hide-group-sep ng-model="model.cheque" class="form-control"> <span class="input-group-btn"> <button ng-click="addCheque()" class="btn btn-success"> Incluir </button> </span> </div> </div> </li> <li ng-repeat="cheque in cheques track by $index" class="list-group-item"> {{ cheque | currency:"R$ "}} <button ng-click="removeCheque($index)" class="btn btn-danger btn-xs pull-right"> <span class="fa fa-remove fa-xs"></span> </button> </li> </ul> </div> <div class="col-xs-12 col-md-4"> <div class="panel panel-default"> <div class="panel-body"> <div class="form-group"> <label for="" class="form-control-label">Valor a ser pago:</label> <div class="input-group"> <span class="input-group-addon">R$</span> <input ui-number-mask ui-hide-group-sep type="text" class="form-control" ng-model="valor"> <span class="input-group-btn"> <button ng-click="execute()" class="btn btn-primary"> <span class="fa fa-refresh"></span> Executar </button> </span> </div> </div> <div ng-show="melhorCombinacaoComTroco.length > 0"> <hr> <strong>Menor troco: </strong> {{ ( troco || 0 ) | currency:"R$ " }} <div> <strong>Cheques: </strong> <span ng-repeat="cheque in melhorCombinacaoComTroco track by $index"> <span ng-if="$index > 0" style="margin-left: 4px">+</span> <span class="label label-primary"> {{ cheque | currency:"R$ " }} </span> </span> </div> </div> <div ng-show="melhorCombinacaoComDiferenca.length > 0"> <hr> <strong>Menor diferenca: </strong> {{ ( menorDiferenca || 0 ) | currency:"R$ " }} <div> <strong>Cheques: </strong> <span ng-repeat="cheque in melhorCombinacaoComDiferenca track by $index"> <span ng-if="$index > 0" style="margin-left: 4px">+</span> <span class="label label-primary"> {{ cheque | currency:"R$ " }} </span> </span> </div> </div> <div ng-show="maiorCombinacaoComDiferenca.length > 0"> <hr> <p>Usando o maior número de cheques, com a menor diferença:</p> <strong>Diferenca: </strong> {{ ( diferencaMaiorCombinacao || 0 ) | currency:"R$ " }} <div> <strong>Cheques: </strong> <span ng-repeat="cheque in maiorCombinacaoComDiferenca track by $index"> <span ng-if="$index > 0" style="margin-left: 4px">+</span> <span class="label label-primary"> {{ cheque | currency:"R$ " }} </span> </span> </div> </div> <!--<div ng-show="menorCombinacaoComDiferenca.length > 0">\n          <hr>\n          <p>Usando o menor número de cheques, com a menor diferença:</p>\n          <strong>Diferenca: </strong> {{ ( diferencaMenorCombinacao || 0 ) | currency:"R$ " }}\n          <div>\n            <strong>Cheques: </strong>\n            <span \n              ng-repeat="cheque in menorCombinacaoComDiferenca track by $index">\n              <span ng-if="$index > 0" style="margin-left: 4px">+</span>\n              <span class="label label-primary">\n                {{ cheque | currency:"R$ " }}\n              </span>\n            </span>\n          </div>\n        </div>--> </div> </div> </div> </div>')}]);